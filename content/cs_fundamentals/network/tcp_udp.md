+++
title = "TCPì™€ UDP (Transmission Control Protocol / User Datagram Protocol)"
date = 2025-03-01

[extra]
categories = "cs_fundamentals-network"
+++

# TCPì™€ UDP

## í•µì‹¬ ì¸ì‚¬ì´íŠ¸ (3ì¤„ ìš”ì•½)
> **TCP**: ì—°ê²°í˜•, ì‹ ë¢°ì„± ë³´ì¥, ìˆœì„œ ë³´ì¥. **UDP**: ë¹„ì—°ê²°í˜•, ë¹ ë¦„, ì‹ ë¢°ì„± ì—†ìŒ. ìš©ë„ì— ë”°ë¼ ì„ íƒ: íŒŒì¼ ì „ì†¡ì€ TCP, ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°ì€ UDP.

## 1. ê°œë…

### TCP (Transmission Control Protocol)
**ì—°ê²° ì§€í–¥í˜• í”„ë¡œí† ì½œ**ë¡œ, ì‹ ë¢°ì„± ìˆëŠ” ë°ì´í„° ì „ì†¡ì„ ë³´ì¥í•œë‹¤.

> ë¹„ìœ : "ë“±ê¸° ìš°í¸" - ìˆ˜ì‹  í™•ì¸, ìˆœì„œ ë³´ì¥

### UDP (User Datagram Protocol)
**ë¹„ì—°ê²°í˜• í”„ë¡œí† ì½œ**ë¡œ, ë¹ ë¥¸ ì „ì†¡ì— ì¤‘ì ì„ ë‘”ë‹¤.

> ë¹„ìœ : "ì—½ì„œ" - ë³´ë‚´ê³  ë, í™•ì¸ ì—†ìŒ

## 2. TCP vs UDP ë¹„êµ

| í•­ëª© | TCP | UDP |
|------|-----|-----|
| ì—°ê²° | ì—°ê²°í˜• | ë¹„ì—°ê²°í˜• |
| ì‹ ë¢°ì„± | ë³´ì¥ | ë¯¸ë³´ì¥ |
| ìˆœì„œ | ë³´ì¥ | ë¯¸ë³´ì¥ |
| íë¦„ì œì–´ | ìˆìŒ | ì—†ìŒ |
| í˜¼ì¡ì œì–´ | ìˆìŒ | ì—†ìŒ |
| ì†ë„ | ëŠë¦¼ | ë¹ ë¦„ |
| í—¤ë” | 20ë°”ì´íŠ¸ | 8ë°”ì´íŠ¸ |
| ìš©ë„ | íŒŒì¼, ì›¹ | ìŠ¤íŠ¸ë¦¬ë°, ê²Œì„ |

## 3. TCP ìƒì„¸

### 3.1 TCP í—¤ë”
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Source Port (16)    â”‚  Destination Port (16) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 Sequence Number (32)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               Acknowledgment Number (32)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ HLEN  â”‚  Flag â”‚  Window   â”‚     Checksum (16)     â”‚
â”‚ (4)   â”‚ (6)   â”‚  (16)     â”‚                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               Urgent Pointer (16)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   Options                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì£¼ìš” í”Œë˜ê·¸:
- SYN: ì—°ê²° ì„¤ì •
- ACK: í™•ì¸ ì‘ë‹µ
- FIN: ì—°ê²° ì¢…ë£Œ
- RST: ì—°ê²° ì¬ì„¤ì •
- PSH: ë°ì´í„° ë°€ì–´ë„£ê¸°
- URG: ê¸´ê¸‰ ë°ì´í„°
```

### 3.2 3-Way Handshake
```
ì—°ê²° ì„¤ì • ê³¼ì •:

Client                    Server
   â”‚                         â”‚
   â”‚ â”€â”€â”€â”€ SYN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ (ì—°ê²° ìš”ì²­)
   â”‚      (SEQ=100)         â”‚
   â”‚                         â”‚
   â”‚ â†â”€â”€ SYN+ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ (ìš”ì²­ ìˆ˜ë½ + í™•ì¸)
   â”‚    (SEQ=300, ACK=101)  â”‚
   â”‚                         â”‚
   â”‚ â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ (í™•ì¸)
   â”‚      (ACK=301)         â”‚
   â”‚                         â”‚
   â”‚      [ì—°ê²° ì™„ë£Œ]         â”‚

ë‹¨ê³„:
1. SYN: í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²° ìš”ì²­
2. SYN+ACK: ì„œë²„ê°€ ìš”ì²­ ìˆ˜ë½
3. ACK: í´ë¼ì´ì–¸íŠ¸ê°€ í™•ì¸
```

### 3.3 4-Way Handshake
```
ì—°ê²° ì¢…ë£Œ ê³¼ì •:

Client                    Server
   â”‚                         â”‚
   â”‚ â”€â”€â”€â”€ FIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ (ì¢…ë£Œ ìš”ì²­)
   â”‚                         â”‚
   â”‚ â†â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ (í™•ì¸)
   â”‚                         â”‚
   â”‚ â†â”€â”€â”€â”€ FIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ (ì¢…ë£Œ ìš”ì²­)
   â”‚                         â”‚
   â”‚ â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ (í™•ì¸)
   â”‚                         â”‚
   â”‚      [ì—°ê²° ì¢…ë£Œ]         â”‚

TIME_WAIT:
- ë§ˆì§€ë§‰ ACK ìœ ì‹¤ ëŒ€ë¹„
- 2MSL(Max Segment Lifetime) ëŒ€ê¸°
```

### 3.4 ìŠ¬ë¼ì´ë”© ìœˆë„ìš°
```
íë¦„ ì œì–´ ê¸°ë²•:

ì†¡ì‹  ìœˆë„ìš°:
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ 1 â”‚ 2 â”‚ 3 â”‚ 4 â”‚ 5 â”‚ 6 â”‚ 7 â”‚ 8 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
  â†‘           â†‘
  ì „ì†¡ë¨      ì „ì†¡ ê°€ëŠ¥

ìˆ˜ì‹  ACKì— ë”°ë¼ ìœˆë„ìš° ì´ë™:
- ACK 1 â†’ ìœˆë„ìš° ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™
- ì—°ì† ì „ì†¡ ê°€ëŠ¥

ì¥ì :
- íš¨ìœ¨ì  ì „ì†¡
- ëŒ€ê¸° ì‹œê°„ ìµœì†Œí™”
```

### 3.5 í˜¼ì¡ ì œì–´
```
ë„¤íŠ¸ì›Œí¬ í˜¼ì¡ ë°©ì§€ ì•Œê³ ë¦¬ì¦˜:

1. Slow Start
   - ì´ˆê¸° cwnd = 1 MSS
   - ACKë§ˆë‹¤ cwnd 2ë°°
   - ssthreshê¹Œì§€ ì§€ìˆ˜ ì¦ê°€

2. Congestion Avoidance
   - ssthresh ì´í›„ ì„ í˜• ì¦ê°€
   - RTTë§ˆë‹¤ cwnd + 1

3. Fast Retransmit
   - 3ë²ˆì˜ ì¤‘ë³µ ACK â†’ ì¦‰ì‹œ ì¬ì „ì†¡

4. Fast Recovery
   - ssthresh = cwnd/2
   - cwnd = ssthresh + 3
```

## 4. UDP ìƒì„¸

### 4.1 UDP í—¤ë”
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Source Port (16) â”‚ Dest Port (16) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Length (16)     â”‚  Checksum (16)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

íŠ¹ì§•:
- 8ë°”ì´íŠ¸ë¡œ ë§¤ìš° ê°„ë‹¨
- ìµœì†Œí•œì˜ ê¸°ëŠ¥ë§Œ
```

### 4.2 UDP íŠ¹ì„±
```
ì¥ì :
- ë¹ ë¥¸ ì „ì†¡
- ì˜¤ë²„í—¤ë“œ ì ìŒ
- ë©€í‹°ìºìŠ¤íŠ¸/ë¸Œë¡œë“œìºìŠ¤íŠ¸ ê°€ëŠ¥

ë‹¨ì :
- ì‹ ë¢°ì„± ì—†ìŒ
- ìˆœì„œ ë³´ì¥ ì—†ìŒ
- íë¦„ ì œì–´ ì—†ìŒ

ì ìš©:
- ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°
- ì˜¨ë¼ì¸ ê²Œì„
- DNS
- VoIP
```

## 5. í¬íŠ¸ ë²ˆí˜¸

```
ì˜ ì•Œë ¤ì§„ í¬íŠ¸ (0~1023):
- 20/21: FTP
- 22: SSH
- 23: Telnet
- 25: SMTP
- 53: DNS
- 80: HTTP
- 110: POP3
- 143: IMAP
- 443: HTTPS
- 3306: MySQL
- 3389: RDP

ë“±ë¡ëœ í¬íŠ¸ (1024~49151):
- 3000: ê°œë°œ ì„œë²„
- 8080: ëŒ€ì²´ HTTP

ë™ì  í¬íŠ¸ (49152~65535):
- í´ë¼ì´ì–¸íŠ¸ ì„ì‹œ í¬íŠ¸
```

## 6. ì½”ë“œ ì˜ˆì‹œ

```python
import socket
import time

class TCPSimulator:
    """TCP ì‹œë®¬ë ˆì´í„°"""

    def __init__(self):
        self.state = 'CLOSED'
        self.seq = 0
        self.ack = 0

    def connect(self):
        """3-way handshake ì‹œë®¬ë ˆì´ì…˜"""
        print("=== 3-Way Handshake ===")

        # SYN
        print(f"Client â†’ Server: SYN (SEQ={self.seq})")
        self.state = 'SYN_SENT'

        # SYN+ACK
        self.seq += 1
        server_seq = 1000
        print(f"Server â†’ Client: SYN+ACK (SEQ={server_seq}, ACK={self.seq})")
        self.ack = server_seq + 1

        # ACK
        print(f"Client â†’ Server: ACK (ACK={self.ack})")
        self.state = 'ESTABLISHED'

        print("ì—°ê²° ì™„ë£Œ!\n")

    def send_data(self, data):
        """ë°ì´í„° ì „ì†¡ ì‹œë®¬ë ˆì´ì…˜"""
        segments = []
        for i, chunk in enumerate(data):
            segment = {
                'seq': self.seq,
                'data': chunk,
                'ack': self.ack
            }
            segments.append(segment)
            print(f"ì „ì†¡: SEQ={self.seq}, Data='{chunk}'")
            self.seq += len(chunk.encode())
            self.ack += 1

        return segments

    def close(self):
        """4-way handshake ì‹œë®¬ë ˆì´ì…˜"""
        print("\n=== 4-Way Handshake ===")

        # FIN
        print(f"Client â†’ Server: FIN")
        self.state = 'FIN_WAIT_1'

        # ACK
        print(f"Server â†’ Client: ACK")
        self.state = 'FIN_WAIT_2'

        # FIN
        print(f"Server â†’ Client: FIN")

        # ACK
        print(f"Client â†’ Server: ACK")
        self.state = 'TIME_WAIT'

        print("ì—°ê²° ì¢…ë£Œ!\n")


class UDPSimulator:
    """UDP ì‹œë®¬ë ˆì´í„°"""

    def __init__(self):
        self.packets_sent = 0

    def send(self, data, dest_addr):
        """ë°ì´í„° ì „ì†¡"""
        self.packets_sent += 1
        packet = {
            'dest': dest_addr,
            'data': data,
            'length': len(data)
        }
        print(f"UDP ì „ì†¡: {dest_addr}, Data='{data}'")
        return packet

    def receive(self, packet):
        """ë°ì´í„° ìˆ˜ì‹ """
        print(f"UDP ìˆ˜ì‹ : Data='{packet['data']}'")
        return packet['data']


# ì‹¤ì œ ì†Œì¼“ í†µì‹  ì˜ˆì‹œ
def tcp_client_example():
    """ì‹¤ì œ TCP í´ë¼ì´ì–¸íŠ¸ ì˜ˆì‹œ"""
    # ì†Œì¼“ ìƒì„±
    client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    try:
        # ì—°ê²° (3-way handshake ìë™)
        client.connect(('example.com', 80))
        print("TCP ì—°ê²° ì„±ê³µ")

        # HTTP ìš”ì²­ ì „ì†¡
        request = b"GET / HTTP/1.1\r\nHost: example.com\r\n\r\n"
        client.send(request)
        print(f"ìš”ì²­ ì „ì†¡: {len(request)} bytes")

        # ì‘ë‹µ ìˆ˜ì‹ 
        response = client.recv(4096)
        print(f"ì‘ë‹µ ìˆ˜ì‹ : {len(response)} bytes")

    except Exception as e:
        print(f"ì˜¤ë¥˜: {e}")
    finally:
        client.close()


def udp_client_example():
    """ì‹¤ì œ UDP í´ë¼ì´ì–¸íŠ¸ ì˜ˆì‹œ"""
    # ì†Œì¼“ ìƒì„±
    client = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

    try:
        # DNS ì¿¼ë¦¬ ì˜ˆì‹œ (ë¹„ì—°ê²°)
        message = b"Hello UDP"
        client.sendto(message, ('8.8.8.8', 53))
        print(f"UDP ì „ì†¡: {len(message)} bytes")

        # íƒ€ì„ì•„ì›ƒ ì„¤ì •
        client.settimeout(2.0)
        response, addr = client.recvfrom(1024)
        print(f"UDP ìˆ˜ì‹ : {len(response)} bytes from {addr}")

    except socket.timeout:
        print("UDP íƒ€ì„ì•„ì›ƒ (ì‘ë‹µ ì—†ìŒ)")
    finally:
        client.close()


# ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
print("=== TCP ì‹œë®¬ë ˆì´ì…˜ ===")
tcp = TCPSimulator()
tcp.connect()
tcp.send_data("Hello")
tcp.close()

print("=== UDP ì‹œë®¬ë ˆì´ì…˜ ===")
udp = UDPSimulator()
packet = udp.send("Hello UDP", ("192.168.1.1", 8080))
udp.receive(packet)
```

## 7. ì¥ë‹¨ì 

### TCP
| ì¥ì  | ë‹¨ì  |
|-----|------|
| ì‹ ë¢°ì„± ë³´ì¥ | ì˜¤ë²„í—¤ë“œ í¼ |
| ìˆœì„œ ë³´ì¥ | ëŠë¦° ì†ë„ |
| íë¦„ ì œì–´ | ì—°ê²° ê´€ë¦¬ ë³µì¡ |
| í˜¼ì¡ ì œì–´ | ë©€í‹°ìºìŠ¤íŠ¸ ë¶ˆê°€ |

### UDP
| ì¥ì  | ë‹¨ì  |
|-----|------|
| ë¹ ë¥¸ ì†ë„ | ì‹ ë¢°ì„± ì—†ìŒ |
| ì˜¤ë²„í—¤ë“œ ì ìŒ | ìˆœì„œ ë³´ì¥ ì—†ìŒ |
| ë©€í‹°ìºìŠ¤íŠ¸ ê°€ëŠ¥ | íë¦„ ì œì–´ ì—†ìŒ |
| ë‹¨ìˆœí•¨ | í˜¼ì¡ ì œì–´ ì—†ìŒ |

## 8. ì‹¤ë¬´ì—ì„ ? (ê¸°ìˆ ì‚¬ì  íŒë‹¨)
- **ì›¹ ì„œë¹„ìŠ¤**: TCP (HTTP/3ëŠ” QUIC ì‚¬ìš©)
- **ìŠ¤íŠ¸ë¦¬ë°**: UDP + ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ ì‹ ë¢°ì„±
- **ê²Œì„**: UDP (ì§€ì—° ë¯¼ê°)
- **íŒŒì¼ ì „ì†¡**: TCP (ì‹ ë¢°ì„± ì¤‘ìš”)

## 9. ê´€ë ¨ ê°œë…
- í¬íŠ¸
- ì†Œì¼“
- íë¦„ ì œì–´
- í˜¼ì¡ ì œì–´

---

## ì–´ë¦°ì´ë¥¼ ìœ„í•œ ì¢…í•© ì„¤ëª…

**TCPì™€ UDPëŠ” "í¸ì§€ vs ì—½ì„œ"ì•¼!**

### TCP (ë“±ê¸° í¸ì§€) ğŸ“¨
```
1. "í¸ì§€ ë³´ë‚¼ê²Œ!" â†’ "ì‘, ì¤€ë¹„ëì–´"
2. í¸ì§€ ë³´ë‚´ê¸°
3. "ì˜ ë°›ì•˜ì–´?" â†’ "ì‘!"

ì¥ì : í™•ì‹¤íˆ ì „ë‹¬ë¼ìš”
ë‹¨ì : ì‹œê°„ì´ ê±¸ë ¤ìš”
```

### UDP (ì—½ì„œ) ğŸ“¬
```
1. ì—½ì„œ ë˜ì§€ê¸° â†’ ë!

ì¥ì : ë¹¨ë¼ìš”
ë‹¨ì : ìƒì–´ë²„ë¦´ ìˆ˜ ìˆì–´ìš”
```

### ì–¸ì œ ë­ ì¨ìš”?
```
TCP: íŒŒì¼, ì›¹í˜ì´ì§€, ì´ë©”ì¼
UDP: ì˜ìƒ, ê²Œì„, ì „í™”
```

**ë¹„ë°€**: ì¸í„°ë„·ì€ TCPì™€ UDPë¥¼ í•¨ê»˜ ì¨ìš”! ğŸŒâœ¨
