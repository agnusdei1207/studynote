+++
title = "회선 교환 / 패킷 교환 (Circuit / Packet Switching)"
date = 2025-03-01

[extra]
categories = "cs_fundamentals-network"
+++

# 회선 교환 / 패킷 교환 (Circuit / Packet Switching)

## 핵심 인사이트 (3줄 요약)
> **회선 교환**: 통신 전 전용 경로를 설정하여 독점 사용. **패킷 교환**: 데이터를 패킷으로 나누어 저장 후 전달. 현대 인터넷은 효율적인 패킷 교환 방식을 사용한다.

## 1. 개념

### 회선 교환 (Circuit Switching)
통신 시작 전 **송신자와 수신자 간 전용 경로를 설정**하고, 통신이 끝날 때까지 독점 사용하는 방식이다.

> 비유: "전화 통화" - 연결되면 회선을 독점

### 패킷 교환 (Packet Switching)
데이터를 **일정 크기의 패킷으로 분할**하여 네트워크를 통해 전송하고, 수신 측에서 재조립하는 방식이다.

> 비유: "우편 엽서" - 여러 경로로 분할 배송 가능

## 2. 회선 교환 상세

### 2.1 동작 과정
```
1. 연결 설정 (Call Setup)
   송신 → 수신: 연결 요청
   수신 → 송신: 연결 승인

2. 데이터 전송
   ───────────────────
   │ 전용 회선 독점 사용 │
   ───────────────────

3. 연결 해제 (Call Teardown)
   송신 → 수신: 연결 종료
```

### 2.2 구조
```
┌─────┐                    ┌─────┐
│ A   │════════════════════│ B   │
└─────┘   전용 회선         └─────┘

특징: 연결된 동안 다른 사용자 사용 불가
```

### 2.3 장단점

| 장점 | 단점 |
|-----|------|
| 전송 지연 일정 | 회선 효율 낮음 |
| 순서 보장 | 연결 설정 시간 |
| 높은 신뢰성 | 회선 고장 시 통신 두절 |
| 실시간 통신 적합 | 유휴 시간 낭비 |

## 3. 패킷 교환 상세

### 3.1 동작 과정
```
1. 패킷화 (Packetization)
   원본 데이터 → [P1][P2][P3][P4]

2. 전송
   P1 → 라우터1 → 라우터2 → 목적지
   P2 → 라우터2 → 라우터3 → 목적지
   P3 → 라우터1 → 라우터2 → 목적지
   P4 → 라우터3 → 라우터2 → 목적지

3. 재조립
   [P1][P2][P3][P4] → 원본 데이터
```

### 3.2 패킷 구조
```
┌────────────────────────────────┐
│       헤더 (Header)            │
│ - 송/수신지 주소               │
│ - 패킷 번호                    │
│ - 프로토콜 정보                │
├────────────────────────────────┤
│       페이로드 (Payload)       │
│ - 실제 데이터                  │
├────────────────────────────────┤
│       트레일러 (Trailer)       │
│ - 오류 검출 코드               │
└────────────────────────────────┘
```

### 3.3 패킷 교환 방식

#### 데이터그램 (Datagram)
```
- 비연결형
- 각 패킷 독립 라우팅
- 순서 보장 없음
- 예: IP, UDP

송신          네트워크           수신
 [P1] ──────────────────────────→ [P3]
 [P2] ──────────────────────────→ [P1]
 [P3] ──────────────────────────→ [P2]
```

#### 가상 회선 (Virtual Circuit)
```
- 연결형
- 논리적 경로 설정
- 순서 보장
- 예: X.25, ATM, MPLS

송신          네트워크           수신
 [P1] ────→ [경로1] ────→      [P1]
 [P2] ────→ [경로1] ────→      [P2]
 [P3] ────→ [경로1] ────→      [P3]
```

### 3.4 장단점

| 장점 | 단점 |
|-----|------|
| 회선 효율 높음 | 전송 지연 변동 |
| 오류 복구 용이 | 패킷 손실 가능 |
| 우회 경로 가능 | 순서 바뀔 수 있음 |
| 비용 효율적 | QoS 보장 어려움 |

## 4. 비교표

| 항목 | 회선 교환 | 패킷 교환 |
|------|----------|-----------|
| 연결 방식 | 연결형 | 연결형/비연결형 |
| 경로 | 고정 | 가변 |
| 대역폭 | 고정 할당 | 공유 |
| 전송 지연 | 일정 | 변동 |
| 회선 효율 | 낮음 | 높음 |
| 오류 복구 | 어려움 | 용이 |
| 실시간 | 적합 | QoS 필요 |
| 예시 | 전화망 | 인터넷 |

## 5. 저장 후 전달 (Store and Forward)

```
패킷 교환의 핵심 기법:

라우터
┌─────────────────────────────────┐
│  1. 패킷 수신                   │
│  2. 오류 검사                   │
│  3. 전체 패킷 저장              │
│  4. 라우팅 테이블 조회          │
│  5. 적절한 포트로 전송          │
└─────────────────────────────────┘

장점: 오류 전파 방지, 버퍼링 가능
단점: 지연 발생
```

## 6. 메시지 교환 vs 패킷 교환

| 항목 | 메시지 교환 | 패킷 교환 |
|------|------------|-----------|
| 단위 | 전체 메시지 | 패킷 |
| 크기 | 가변 (큼) | 고정 (작음) |
| 지연 | 큼 | 작음 |
| 버퍼 | 많이 필요 | 적게 필요 |

## 7. 활용 사례

### 회선 교환
- **PSTN**: 공중 전화망
- **ISDN**: 종합 정보 통신망
- **TDM**: 시분할 다중화 회선

### 패킷 교환
- **인터넷**: TCP/IP 네트워크
- **이더넷**: LAN 환경
- **ATM**: 비동기 전송 모드
- **프레임 릴레이**: WAN 기술

## 8. 코드 예시

```python
import time
import random

class CircuitSwitch:
    """회선 교환 시뮬레이션"""
    def __init__(self):
        self.connection = False

    def connect(self, src, dst):
        print(f"[회선 교환] {src} → {dst} 연결 설정 중...")
        time.sleep(0.5)  # 연결 설정 시간
        self.connection = True
        print(f"[회선 교환] 연결 완료!")

    def send(self, data):
        if not self.connection:
            print("연결되지 않음!")
            return
        print(f"[회선 교환] 전송: {data}")
        time.sleep(0.1)  # 일정한 전송 지연

    def disconnect(self):
        self.connection = False
        print("[회선 교환] 연결 해제")


class PacketSwitch:
    """패킷 교환 시뮬레이션"""
    def send(self, src, dst, data, packet_size=10):
        # 패킷화
        packets = [data[i:i+packet_size]
                   for i in range(0, len(data), packet_size)]

        print(f"[패킷 교환] {len(packets)}개 패킷으로 분할")

        # 각 패킷 전송 (경로 가변)
        for i, packet in enumerate(packets):
            delay = random.uniform(0.05, 0.2)  # 변동 지연
            route = random.randint(1, 3)
            time.sleep(delay)
            print(f"[패킷 교환] P{i+1} 경로{route}: {packet}")

        print("[패킷 교환] 수신 측에서 재조립 완료")


# 비교 테스트
data = "Hello, this is a test message for switching comparison!"

print("=== 회선 교환 ===")
cs = CircuitSwitch()
cs.connect("A", "B")
cs.send(data)
cs.disconnect()

print("\n=== 패킷 교환 ===")
ps = PacketSwitch()
ps.send("A", "B", data)
```

## 9. 실무에선? (기술사적 판단)
- **인터넷**: 패킷 교환이 표준
- **실시간 통화**: VoIP는 패킷 교환 + QoS
- **전용선**: 회선 교환 개념 활용
- **하이브리드**: MPLS로 두 방식 장점 결합

## 10. 관련 개념
- 가상 회선 (Virtual Circuit)
- 데이터그램 (Datagram)
- 저장 후 전달 (Store and Forward)
- QoS (Quality of Service)

---

## 어린이를 위한 종합 설명

**회선 교환 vs 패킷 교환은 "전화 vs 편지"야!**

### 회선 교환 (전화) 📞
```
나 ────→ 친구

연결: "여보세요?"
대화: 독점 선! 다른 사람 못 써요
종료: "끊을게"

장점: 끊김 없이 대화해요
단점: 아무 말 안 해도 회선 차지
```

### 패킷 교환 (편지) 📬
```
편지를 여러 조각으로:

[안] [녕] [하] [세] [요]

각 조각이 다른 우체국 거쳐서 도착!

장점: 한 번에 많은 사람이 써요
단점: 순서가 바뀔 수 있어요
```

**비밀**: 인터넷은 패킷 교환을 써서 효율적이에요! 🌐✨
