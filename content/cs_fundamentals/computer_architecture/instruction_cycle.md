+++
title = "명령어 사이클 (Instruction Cycle)"
date = 2025-02-27
+++

# 명령어 사이클 (Instruction Cycle)

## 핵심 인사이트 (3줄 요약)
> CPU가 **명령어를 실행하는 일련의 단계**. 인출(Fetch), 해석(Decode), 실행(Execute)으로 구성된다. 각 단계가 파이프라인으로 병렬 처리되어 성능이 향상된다.

## 1. 개념
명령어 사이클(Instruction Cycle)은 **CPU가 한 명령어를 처리하는 전체 과정**이다. 인출-해석-실행-저장의 단계로 이루어진다.

> 비유: "요리 과정" - 레시피 보기 → 재료 준비 → 요리 → 접시에 담기

## 2. 기본 명령어 사이클

```
┌─────────────────────────────────────────┐
│                                         │
│   ┌───────┐    ┌───────┐    ┌───────┐  │
│   │ Fetch │───→│Decode │───→│Execute│  │
│   └───────┘    └───────┘    └───────┘  │
│       ↑                         │       │
│       └─────────────────────────┘       │
│              (다음 명령어)               │
└─────────────────────────────────────────┘
```

## 3. 각 단계 설명

### Fetch (인출)
```
1. PC 값을 MAR로 전송
2. 메모리에서 명령어 읽기
3. 명령어를 IR에 저장
4. PC 증가
```

### Decode (해석)
```
1. IR의 명령어 분석
2. 연산 코드(opcode) 확인
3. 필요한 레지스터 식별
4. 제어 신호 생성
```

### Execute (실행)
```
1. ALU 연산 수행
2. 메모리 접근 (필요시)
3. 결과 저장
```

## 4. 확장된 명령어 사이클

```
┌───────┐   ┌───────┐   ┌───────┐   ┌───────┐   ┌───────┐
│ Fetch │──→│Decode │──→│Execute│──→│ Memory│──→│Write  │
│  IF   │   │  ID   │   │  EX   │   │  MEM  │   │  WB   │
└───────┘   └───────┘   └───────┘   └───────┘   └───────┘

IF: Instruction Fetch
ID: Instruction Decode
EX: Execute
MEM: Memory Access
WB: Write Back
```

## 5. 인터럽트 사이클

```
명령어 사이클 중 인터럽트 발생 시:

┌───────┐   ┌───────┐   ┌───────┐
│ Fetch │──→│Decode │──→│Execute│
└───────┘   └───────┘   └───────┘
    ↓
┌───────────────┐
│ 인터럽트 확인  │
└───────┬───────┘
        │ 인터럽트 있음
        ↓
┌───────────────┐
│ 인터럽트 처리  │
│ (ISR 실행)    │
└───────────────┘
```

## 6. 마이크로 오퍼레이션

```
Fetch 단계의 마이크로 오퍼레이션:

T1: MAR ← PC
T2: MBR ← Memory[MAR], PC ← PC + 1
T3: IR ← MBR

각 T는 클럭 사이클
```

## 7. 파이프라인에서의 사이클

```
파이프라인 없이:
명령어1: [IF][ID][EX][MEM][WB]
명령어2:                    [IF][ID][EX][MEM][WB]

파이프라인:
명령어1: [IF][ID][EX][MEM][WB]
명령어2:    [IF][ID][EX][MEM][WB]
명령어3:       [IF][ID][EX][MEM][WB]

→ 매 클럭마다 한 명령어 완료 효과
```

## 8. 성능 지표

```
CPI (Cycles Per Instruction):
- 이상적: 1 CPI (파이프라인)
- 실제: 1~2 CPI

IPC (Instructions Per Cycle):
- 이상적: 1 IPC
- 슈퍼스칼라: 2+ IPC

실행 시간 = 명령어 수 × CPI × 클럭 주기
```

## 9. 장단점

| 장점 | 단점 |
|-----|------|
| 체계적 구조 | 해저드 발생 가능 |
| 파이프라인 용이 | 분기 비용 |

## 10. 실무에선? (기술사적 판단)
- **CPU 설계**: 파이프라인 최적화
- **성능 분석**: CPI/IPC 측정
- **컴파일러**: 명령어 스케줄링
- **보안**: 사이드 채널 공격 방지

## 11. 관련 개념
- 파이프라이닝
- 마이크로 오퍼레이션
- CPI/IPC

---

## 어린이를 위한 종합 설명

**명령어 사이클은 "요리 과정"이야!**

### 요리로 비유하면
```
1. Fetch (인출)
   레시피 펼치기 📖

2. Decode (해석)
   "달걀 2개를..." 읽기 🥚

3. Execute (실행)
   달걀 깨기, 젓기 🍳

4. Memory (접근)
   냉장고에서 재료 꺼내기

5. Write Back (저장)
   접시에 담기 🍽️
```

### 파이프라인
```
혼자 하면:
요리1 완료 → 요리2 시작 → ...

여러 명이 분업:
사람1: 레시피 읽기
사람2: 재료 준비
사람3: 요리하기
사람4: 접시에 담기

→ 동시에 여러 요리 진행! 🏃🏃
```

**비밀**: CPU는 1초에 수십억 번 이 과정을 반복해요! ⚡
