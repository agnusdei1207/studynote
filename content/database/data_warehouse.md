+++
title = "ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ (Data Warehouse)"
date = 2025-03-01

[extra]
categories = "database-relational"
+++

# ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ (Data Warehouse)

## í•µì‹¬ ì¸ì‚¬ì´íŠ¸ (3ì¤„ ìš”ì•½)
> **ì˜ì‚¬ê²°ì •ì„ ìœ„í•œ ì£¼ì œ ì¤‘ì‹¬ì˜ í†µí•© ë°ì´í„° ì €ì¥ì†Œ**. ìš´ì˜ DBì™€ ë¶„ë¦¬ëœ ì½ê¸° ì „ìš© DBë¡œ, ETLì„ í†µí•´ ë°ì´í„°ë¥¼ ìˆ˜ì§‘. ë‹¤ì°¨ì› ë¶„ì„, OLAP, ë°ì´í„° ë§ˆì´ë‹ ì§€ì›.

## 1. ê°œë…
ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ëŠ” **ê¸°ì—…ì˜ ì˜ì‚¬ê²°ì • ì§€ì›ì„ ìœ„í•´ ì£¼ì œë³„ë¡œ í†µí•©ëœ, ì‹œê³„ì—´ì ì´ê³  ë¹„íœ˜ë°œì„±ì¸ ë°ì´í„° ì €ì¥ì†Œ**ì´ë‹¤.

> ë¹„ìœ : "ê¸°ì—…ì˜ ê¸°ì–µ ì €ì¥ì†Œ" - ê³¼ê±°ë¶€í„° í˜„ì¬ê¹Œì§€ ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„°ë¥¼ í•œ ê³³ì—

## 2. ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ íŠ¹ì„±

```
W.H. Inmonì˜ 4ê°€ì§€ íŠ¹ì„±:

1. ì£¼ì œ ì§€í–¥ (Subject-Oriented)
   - ì—…ë¬´ ì¤‘ì‹¬ì´ ì•„ë‹Œ ì£¼ì œ ì¤‘ì‹¬
   - ì˜ˆ: ê³ ê°, ìƒí’ˆ, íŒë§¤

2. í†µí•© (Integrated)
   - ì´ê¸°ì¢… ë°ì´í„° ì†ŒìŠ¤ í†µí•©
   - ë°ì´í„° í‘œì¤€í™” (ë‹¨ìœ„, ì½”ë“œ ë“±)

3. ì‹œê³„ì—´ (Time-Variant)
   - ê³¼ê±° ë°ì´í„° ë³´ê´€
   - ìŠ¤ëƒ…ìƒ· í˜•íƒœ ì €ì¥

4. ë¹„íœ˜ë°œì„± (Non-Volatile)
   - ì½ê¸° ì „ìš©
   - ë°ì´í„° ìˆ˜ì •/ì‚­ì œ ì—†ìŒ
```

## 3. ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë°ì´í„° ì†ŒìŠ¤ (Source)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  ERP   â”‚ â”‚  CRM   â”‚ â”‚  SCM   â”‚ â”‚  ë¡œê·¸   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ETL (ì¶”ì¶œ, ë³€í™˜, ì ì¬)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚Extract  â”‚â”€â”€â”€â†’â”‚Transformâ”‚â”€â”€â”€â†’â”‚  Load   â”‚                 â”‚
â”‚  â”‚(ì¶”ì¶œ)   â”‚    â”‚(ë³€í™˜)   â”‚    â”‚(ì ì¬)   â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    íŒ©íŠ¸ í…Œì´ë¸”                        â”‚  â”‚
â”‚  â”‚              (Fact Table: ìˆ˜ì¹˜ ë°ì´í„°)                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ ì‹œê°„   â”‚ â”‚ ìƒí’ˆ   â”‚ â”‚ ì§€ì—­   â”‚ â”‚ ê³ ê°   â”‚              â”‚
â”‚  â”‚ì°¨ì›í…Œì´ë¸”â”‚ â”‚ì°¨ì›í…Œì´ë¸”â”‚ â”‚ì°¨ì›í…Œì´ë¸”â”‚ â”‚ì°¨ì›í…Œì´ë¸”â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë°ì´í„° ë§ˆíŠ¸ (Data Mart)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  ì˜ì—… ë§ˆíŠ¸  â”‚  â”‚  ë§ˆì¼€íŒ… ë§ˆíŠ¸ â”‚  â”‚  ì¬ë¬´ ë§ˆíŠ¸  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BI/ë¶„ì„ ë„êµ¬                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ ë¦¬í¬íŠ¸ â”‚ â”‚  OLAP  â”‚ â”‚ ëŒ€ì‹œë³´ë“œâ”‚ â”‚ ë§ˆì´ë‹ â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4. ë‹¤ì°¨ì› ëª¨ë¸ë§

### 4.1 ìŠ¤íƒ€ ìŠ¤í‚¤ë§ˆ (Star Schema)
```
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   ì‹œê°„       â”‚
                â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
                â”‚ ì‹œê°„í‚¤ (PK)  â”‚
                â”‚ ë…„, ì›”, ì¼   â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ìƒí’ˆ       â”‚       â”‚        â”‚   ì§€ì—­       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚       â”‚        â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ìƒí’ˆí‚¤ (PK)  â”‚â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”‚ ì§€ì—­í‚¤ (PK)  â”‚
â”‚ ìƒí’ˆëª…       â”‚       â”‚        â”‚ ì§€ì—­ëª…       â”‚
â”‚ ì¹´í…Œê³ ë¦¬     â”‚       â”‚        â”‚ êµ­ê°€         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
                â”‚   íŒë§¤     â”‚ â† íŒ©íŠ¸ í…Œì´ë¸”
                â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
                â”‚ ì‹œê°„í‚¤(FK) â”‚
                â”‚ ìƒí’ˆí‚¤(FK) â”‚
                â”‚ ì§€ì—­í‚¤(FK) â”‚
                â”‚ ê³ ê°í‚¤(FK) â”‚
                â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
                â”‚ ë§¤ì¶œì•¡     â”‚ â† ì¸¡ì •ê°’
                â”‚ ìˆ˜ëŸ‰       â”‚
                â”‚ ì´ìµ       â”‚
                â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                      â”‚
                â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
                â”‚   ê³ ê°     â”‚
                â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
                â”‚ ê³ ê°í‚¤(PK) â”‚
                â”‚ ê³ ê°ëª…     â”‚
                â”‚ ë“±ê¸‰       â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

íŠ¹ì§•:
- íŒ©íŠ¸ í…Œì´ë¸”: 1ê°œ (ì¤‘ì•™)
- ì°¨ì› í…Œì´ë¸”: ì—¬ëŸ¬ ê°œ (ì£¼ë³€)
- ë³„ ëª¨ì–‘
- ë‹¨ìˆœí•œ ì¡°ì¸
```

### 4.2 ìŠ¤ë…¸ìš°í”Œë ˆì´í¬ ìŠ¤í‚¤ë§ˆ (Snowflake Schema)
```
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  ì‹œê°„   â”‚
                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì¹´í…Œê³ ë¦¬â”‚â”€â”€â”€â”€â”‚   ìƒí’ˆ    â”‚â”€â”€â”€â”€â”‚  ì§€ì—­   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                     â”‚               â”‚
               â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
               â”‚   íŒë§¤    â”‚   â”‚    êµ­ê°€   â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

íŠ¹ì§•:
- ì°¨ì› í…Œì´ë¸” ì •ê·œí™”
- ëˆˆì†¡ì´ ëª¨ì–‘
- ì €ì¥ ê³µê°„ ì ˆì•½
- ì¡°ì¸ ë³µì¡
```

## 5. OLAP (Online Analytical Processing)

### 5.1 OLAP ì—°ì‚°
```
1. Slice (ìŠ¬ë¼ì´ìŠ¤)
   - í•œ ì°¨ì› ê°’ ê³ ì •
   - ì˜ˆ: 2024ë…„ ë°ì´í„°ë§Œ

2. Dice (ë‹¤ì´ìŠ¤)
   - ì—¬ëŸ¬ ì°¨ì› ê°’ ê³ ì •
   - ì˜ˆ: 2024ë…„, ì„œìš¸, ì „ìì œí’ˆ

3. Roll-up (ë¡¤ì—…)
   - ìƒìœ„ ìˆ˜ì¤€ìœ¼ë¡œ ì§‘ê³„
   - ì˜ˆ: ì›” â†’ ë¶„ê¸° â†’ ë…„
   â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
   â”‚ 1ì›”  â”‚ 2ì›”  â”‚ 3ì›”  â”‚
   â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
          â†“
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ 1ë¶„ê¸°   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. Drill-down (ë“œë¦´ë‹¤ìš´)
   - í•˜ìœ„ ìˆ˜ì¤€ìœ¼ë¡œ ìƒì„¸í™”
   - ì˜ˆ: ë…„ â†’ ë¶„ê¸° â†’ ì›”

5. Pivot (í”¼ë²—)
   - ì°¨ì› íšŒì „
   - í–‰ â†” ì—´ êµí™˜
```

### 5.2 OLAP ì¢…ë¥˜
```
MOLAP (Multidimensional OLAP):
- ë‹¤ì°¨ì› ë°°ì—´ ì €ì¥
- ë¹ ë¥¸ ì¡°íšŒ
- ì €ì¥ ê³µê°„ ë§ì´ í•„ìš”

ROLAP (Relational OLAP):
- ê´€ê³„í˜• í…Œì´ë¸” ì‚¬ìš©
- í™•ì¥ì„± ì¢‹ìŒ
- ì„±ëŠ¥ ìƒëŒ€ì ìœ¼ë¡œ ëŠë¦¼

HOLAP (Hybrid OLAP):
- MOLAP + ROLAP
- ìš”ì•½: MOLAP
- ìƒì„¸: ROLAP
```

## 6. ETL í”„ë¡œì„¸ìŠ¤

```
Extract (ì¶”ì¶œ):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì†ŒìŠ¤ ì‹œìŠ¤í…œì—ì„œ ë°ì´í„° ì¶”ì¶œ             â”‚
â”‚ - ì „ì²´ ì¶”ì¶œ                            â”‚
â”‚ - ì¦ë¶„ ì¶”ì¶œ (ë³€ê²½ë¶„ë§Œ)                  â”‚
â”‚ - CDC (Change Data Capture)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
Transform (ë³€í™˜):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë°ì´í„° ì •ì œ ë° ë³€í™˜                    â”‚
â”‚ - ë°ì´í„° ì •ì œ (ê³µë°±, NULL ì²˜ë¦¬)        â”‚
â”‚ - ë°ì´í„° ë³€í™˜ (í˜•ì‹, ë‹¨ìœ„)             â”‚
â”‚ - ë°ì´í„° í†µí•© (ì¤‘ë³µ ì œê±°)              â”‚
â”‚ - ë°ì´í„° ì§‘ê³„                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
Load (ì ì¬):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ì— ì ì¬               â”‚
â”‚ - ì´ˆê¸° ì ì¬ (Initial Load)            â”‚
â”‚ - ì¦ë¶„ ì ì¬ (Incremental Load)        â”‚
â”‚ - ê°±ì‹  ì ì¬ (Refresh Load)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 7. ë°ì´í„° ë§ˆíŠ¸

```
ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ì˜ í•˜ìœ„ ì§‘í•©

íŠ¹ì§•:
- ë¶€ì„œ/ì—…ë¬´ë³„ íŠ¹í™”
- ë” ì‘ì€ ê·œëª¨
- ë” ë¹ ë¥¸ ì¡°íšŒ

ì¢…ë¥˜:
1. ì¢…ì†í˜• ë°ì´í„° ë§ˆíŠ¸
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Data Warehouse  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”
     â–¼       â–¼       â–¼
   â”Œâ”€â”€â”€â”   â”Œâ”€â”€â”€â”   â”Œâ”€â”€â”€â”
   â”‚ì˜ì—…â”‚   â”‚ë§ˆì¼€íŒ…â”‚ â”‚ì¬ë¬´â”‚
   â””â”€â”€â”€â”˜   â””â”€â”€â”€â”˜   â””â”€â”€â”€â”˜

2. ë…ë¦½í˜• ë°ì´í„° ë§ˆíŠ¸
   â”Œâ”€â”€â”€â”   â”Œâ”€â”€â”€â”   â”Œâ”€â”€â”€â”
   â”‚ì˜ì—…â”‚   â”‚ë§ˆì¼€íŒ…â”‚ â”‚ì¬ë¬´â”‚
   â””â”€â”€â”€â”˜   â””â”€â”€â”€â”˜   â””â”€â”€â”€â”˜
     â†‘       â†‘       â†‘
   ì†ŒìŠ¤     ì†ŒìŠ¤     ì†ŒìŠ¤
```

## 8. ì½”ë“œ ì˜ˆì‹œ

```python
from dataclasses import dataclass
from typing import List, Dict, Optional
from datetime import date
from enum import Enum

class AggregationType(Enum):
    SUM = "SUM"
    AVG = "AVG"
    COUNT = "COUNT"
    MAX = "MAX"
    MIN = "MIN"

@dataclass
class Dimension:
    """ì°¨ì› í…Œì´ë¸”"""
    key: int
    attributes: Dict[str, str]

@dataclass
class FactRecord:
    """íŒ©íŠ¸ ë ˆì½”ë“œ"""
    time_key: int
    product_key: int
    region_key: int
    customer_key: int
    revenue: float
    quantity: int
    profit: float

class StarSchema:
    """ìŠ¤íƒ€ ìŠ¤í‚¤ë§ˆ êµ¬í˜„"""

    def __init__(self):
        # ì°¨ì› í…Œì´ë¸”
        self.time_dim: Dict[int, Dimension] = {}
        self.product_dim: Dict[int, Dimension] = {}
        self.region_dim: Dict[int, Dimension] = {}
        self.customer_dim: Dict[int, Dimension] = {}

        # íŒ©íŠ¸ í…Œì´ë¸”
        self.facts: List[FactRecord] = []

    def add_time_dimension(self, key: int, year: int, quarter: int, month: int, day: int):
        """ì‹œê°„ ì°¨ì› ì¶”ê°€"""
        self.time_dim[key] = Dimension(key, {
            'year': str(year),
            'quarter': str(quarter),
            'month': str(month),
            'day': str(day)
        })

    def add_product_dimension(self, key: int, name: str, category: str, brand: str):
        """ìƒí’ˆ ì°¨ì› ì¶”ê°€"""
        self.product_dim[key] = Dimension(key, {
            'name': name,
            'category': category,
            'brand': brand
        })

    def add_region_dimension(self, key: int, city: str, province: str, country: str):
        """ì§€ì—­ ì°¨ì› ì¶”ê°€"""
        self.region_dim[key] = Dimension(key, {
            'city': city,
            'province': province,
            'country': country
        })

    def add_fact(self, time_key: int, product_key: int, region_key: int,
                 customer_key: int, revenue: float, quantity: int, profit: float):
        """íŒ©íŠ¸ ì¶”ê°€"""
        self.facts.append(FactRecord(
            time_key, product_key, region_key, customer_key,
            revenue, quantity, profit
        ))

    def slice_by_time(self, year: int) -> List[FactRecord]:
        """ìŠ¬ë¼ì´ìŠ¤: íŠ¹ì • ì—°ë„"""
        time_keys = [k for k, v in self.time_dim.items()
                     if v.attributes['year'] == str(year)]
        return [f for f in self.facts if f.time_key in time_keys]

    def dice(self, year: int, category: str) -> List[FactRecord]:
        """ë‹¤ì´ìŠ¤: ì—°ë„ + ì¹´í…Œê³ ë¦¬"""
        time_keys = {k for k, v in self.time_dim.items()
                     if v.attributes['year'] == str(year)}
        product_keys = {k for k, v in self.product_dim.items()
                        if v.attributes['category'] == category}

        return [f for f in self.facts
                if f.time_key in time_keys and f.product_key in product_keys]

    def rollup_by_region(self) -> Dict[str, float]:
        """ë¡¤ì—…: ì§€ì—­ë³„ ì§‘ê³„"""
        result = {}
        for fact in self.facts:
            region = self.region_dim[fact.region_key]
            province = region.attributes['province']

            if province not in result:
                result[province] = 0
            result[province] += fact.revenue

        return result

    def drilldown_by_month(self, year: int) -> Dict[str, float]:
        """ë“œë¦´ë‹¤ìš´: ì›”ë³„ ìƒì„¸"""
        result = {}
        for fact in self.facts:
            time_dim = self.time_dim[fact.time_key]
            if time_dim.attributes['year'] == str(year):
                month = time_dim.attributes['month']
                if month not in result:
                    result[month] = 0
                result[month] += fact.revenue

        return result

    def pivot_report(self) -> Dict[str, Dict[str, float]]:
        """í”¼ë²—: ì§€ì—­ë³„-ì¹´í…Œê³ ë¦¬ë³„ ë§¤ì¶œ"""
        result = {}

        for fact in self.facts:
            region = self.region_dim[fact.region_key].attributes['province']
            category = self.product_dim[fact.product_key].attributes['category']

            if region not in result:
                result[region] = {}
            if category not in result[region]:
                result[region][category] = 0

            result[region][category] += fact.revenue

        return result


class ETLPipeline:
    """ETL íŒŒì´í”„ë¼ì¸"""

    def __init__(self):
        self.source_data = []
        self.transformed_data = []

    def extract(self, source: List[Dict]):
        """ì¶”ì¶œ"""
        print(f"Extracting {len(source)} records...")
        self.source_data = source.copy()

    def transform(self):
        """ë³€í™˜"""
        print("Transforming data...")
        self.transformed_data = []

        for record in self.source_data:
            # ë°ì´í„° ì •ì œ
            transformed = {
                'time_key': record['date'].replace('-', ''),
                'product_key': record['product_id'],
                'region_key': record['region_id'],
                'customer_key': record['customer_id'],
                'revenue': float(record['amount']),
                'quantity': int(record['qty']),
                'profit': float(record['amount']) * 0.2  # 20% ë§ˆì§„
            }
            self.transformed_data.append(transformed)

    def load(self, warehouse: StarSchema):
        """ì ì¬"""
        print(f"Loading {len(self.transformed_data)} records...")
        for record in self.transformed_data:
            warehouse.add_fact(
                int(record['time_key']),
                record['product_key'],
                record['region_key'],
                record['customer_key'],
                record['revenue'],
                record['quantity'],
                record['profit']
            )


# ì‚¬ìš© ì˜ˆì‹œ
print("=== ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ ì‹œë®¬ë ˆì´ì…˜ ===\n")

# ìŠ¤íƒ€ ìŠ¤í‚¤ë§ˆ ìƒì„±
dw = StarSchema()

# ì°¨ì› ë°ì´í„° ì¶”ê°€
dw.add_time_dimension(20240101, 2024, 1, 1, 1)
dw.add_time_dimension(20240102, 2024, 1, 1, 2)
dw.add_time_dimension(20240201, 2024, 1, 2, 1)

dw.add_product_dimension(1, "ë…¸íŠ¸ë¶", "ì „ìì œí’ˆ", "ì‚¼ì„±")
dw.add_product_dimension(2, "TV", "ì „ìì œí’ˆ", "LG")
dw.add_product_dimension(3, "ì…”ì¸ ", "ì˜ë¥˜", "ìœ ë‹ˆí´ë¡œ")

dw.add_region_dimension(1, "ì„œìš¸", "ê²½ê¸°", "í•œêµ­")
dw.add_region_dimension(2, "ë¶€ì‚°", "ê²½ë‚¨", "í•œêµ­")

# íŒ©íŠ¸ ë°ì´í„° ì¶”ê°€
dw.add_fact(20240101, 1, 1, 101, 1500000, 5, 300000)
dw.add_fact(20240101, 2, 1, 102, 2000000, 3, 400000)
dw.add_fact(20240102, 1, 2, 103, 1500000, 2, 300000)
dw.add_fact(20240201, 3, 1, 101, 50000, 10, 10000)

# OLAP ì—°ì‚°
print("--- ìŠ¬ë¼ì´ìŠ¤: 2024ë…„ ---")
sliced = dw.slice_by_time(2024)
print(f"ë ˆì½”ë“œ ìˆ˜: {len(sliced)}")

print("\n--- ë‹¤ì´ìŠ¤: 2024ë…„ ì „ìì œí’ˆ ---")
diced = dw.dice(2024, "ì „ìì œí’ˆ")
print(f"ë ˆì½”ë“œ ìˆ˜: {len(diced)}")

print("\n--- ë¡¤ì—…: ì§€ì—­ë³„ ë§¤ì¶œ ---")
rollup = dw.rollup_by_region()
for region, revenue in rollup.items():
    print(f"  {region}: {revenue:,}ì›")

print("\n--- í”¼ë²—: ì§€ì—­ë³„-ì¹´í…Œê³ ë¦¬ë³„ ë§¤ì¶œ ---")
pivot = dw.pivot_report()
for region, categories in pivot.items():
    print(f"\n{region}:")
    for cat, rev in categories.items():
        print(f"  {cat}: {rev:,}ì›")
```

## 9. ë°ì´í„° ë ˆì´í¬ vs ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤

| í•­ëª© | Data Warehouse | Data Lake |
|------|----------------|-----------|
| ë°ì´í„° | ì •í˜• | ì •í˜• + ë¹„ì •í˜• |
| ìŠ¤í‚¤ë§ˆ | ìŠ¤í‚¤ë§ˆ ì˜¨ ë¦¬ë“œ | ìŠ¤í‚¤ë§ˆ ì˜¨ ë¼ì´íŠ¸ |
| ì²˜ë¦¬ | ETL | ELT |
| ë¹„ìš© | ë†’ìŒ | ë‚®ìŒ |
| ì‚¬ìš©ì | ë¹„ì¦ˆë‹ˆìŠ¤ ë¶„ì„ê°€ | ë°ì´í„° ê³¼í•™ì |
| ëª©ì  | BI, ë¦¬í¬íŒ… | ML, íƒìƒ‰ì  ë¶„ì„ |

## 10. ì¥ë‹¨ì 

### ì¥ì 
| ì¥ì  | ì„¤ëª… |
|-----|------|
| í†µí•© ë·° | ì „ì‚¬ì  ë°ì´í„° í†µí•© |
| ì˜ì‚¬ê²°ì • | ë¶„ì„ ê¸°ë°˜ ê²°ì • ì§€ì› |
| ì„±ëŠ¥ | ìš´ì˜ DB ì˜í–¥ ì—†ìŒ |
| ê³¼ê±° ë°ì´í„° | ì‹œê³„ì—´ ë¶„ì„ ê°€ëŠ¥ |

### ë‹¨ì 
| ë‹¨ì  | ì„¤ëª… |
|-----|------|
| ë¹„ìš© | êµ¬ì¶•/ìš´ì˜ ë¹„ìš© ë†’ìŒ |
| ë³µì¡ì„± | ì„¤ê³„/êµ¬í˜„ ì–´ë ¤ì›€ |
| ì§€ì—° | ì‹¤ì‹œê°„ ë¶„ì„ ì–´ë ¤ì›€ |
| ìœ ì—°ì„± | ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì–´ë ¤ì›€ |

## 11. ì‹¤ë¬´ì—ì„ ? (ê¸°ìˆ ì‚¬ì  íŒë‹¨)
- **êµ¬ì¶• ë°©ì‹**: ì²˜ìŒë¶€í„° í¬ê²Œ ë§ê³  ì ì§„ì  í™•ì¥
- **í´ë¼ìš°ë“œ**: Snowflake, BigQuery, Redshift í™œìš©
- **ì‹¤ì‹œê°„**: ì‹¤ì‹œê°„ DW â†’ ìŠ¤íŠ¸ë¦¬ë° + ë°°ì¹˜ í•˜ì´ë¸Œë¦¬ë“œ
- **ë°ì´í„° í’ˆì§ˆ**: ETL í’ˆì§ˆì´ ë¶„ì„ í’ˆì§ˆ ê²°ì •
- **ê±°ë²„ë„ŒìŠ¤**: ë©”íƒ€ë°ì´í„° ê´€ë¦¬ í•„ìˆ˜

## 12. ê´€ë ¨ ê°œë…
- ETL
- OLAP
- ë°ì´í„° ë§ˆíŠ¸
- ë¹„ì¦ˆë‹ˆìŠ¤ ì¸í…”ë¦¬ì „ìŠ¤ (BI)
- ë°ì´í„° ë§ˆì´ë‹

---

## ì–´ë¦°ì´ë¥¼ ìœ„í•œ ì¢…í•© ì„¤ëª…

**ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ëŠ” "ê¸°ì—…ì˜ ë„ì„œê´€"ì´ì—ìš”!**

### ì™œ í•„ìš”í• ê¹Œ? ğŸ“š
```
ê° ë¶€ì„œê°€ ë”°ë¡œ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆì–´ìš”:
- ì˜ì—…íŒ€: íŒë§¤ ë°ì´í„°
- ì¬ë¬´íŒ€: íšŒê³„ ë°ì´í„°
- ì¸ì‚¬íŒ€: ì§ì› ë°ì´í„°

â†’ ì´ê±¸ í•œ ê³³ì— ëª¨ì•„ì„œ ë¶„ì„í•˜ê³  ì‹¶ì–´ìš”!
```

### 4ê°€ì§€ íŠ¹ì„± ğŸ—ï¸
```
1. ì£¼ì œ ì§€í–¥: ì£¼ì œë³„ë¡œ ì •ë¦¬
   "ê³ ê°, ìƒí’ˆ, íŒë§¤"

2. í†µí•©: ëª¨ë“  ë°ì´í„°ë¥¼ í•˜ë‚˜ë¡œ
   "ë‹¨ìœ„, ì½”ë“œë¥¼ í†µì¼"

3. ì‹œê³„ì—´: ì‹œê°„ ìˆœì„œëŒ€ë¡œ
   "ê³¼ê±°~í˜„ì¬ê¹Œì§€ ì €ì¥"

4. ë¹„íœ˜ë°œì„±: ì½ê¸°ë§Œ í•´ìš”
   "ìˆ˜ì •, ì‚­ì œ ì•ˆ í•¨"
```

### ETL ê³¼ì • ğŸ”„
```
Extract(ì¶”ì¶œ) â†’ Transform(ë³€í™˜) â†’ Load(ì ì¬)
   ë°ì´í„° êº¼ë‚´ê¸°    ê¹¨ë—í•˜ê²Œ ë§Œë“¤ê¸°   ì°½ê³ ì— ë„£ê¸°
```

### ìŠ¤íƒ€ ìŠ¤í‚¤ë§ˆ â­
```
        â”Œâ”€â”€â”€â”
        â”‚ì‹œê°„â”‚
        â””â”€â”¬â”€â”˜
    â”Œâ”€â”€â”€â”¬â”€â”´â”€â”¬â”€â”€â”€â”
â”Œâ”€â”€â”€â”¤ìƒí’ˆâ”‚íŒë§¤â”‚ì§€ì—­â”œâ”€â”€â”€â”
â”‚   â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜   â”‚
â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€ ê³ ê° â”€â”€â”€â”€â”€â”€â”˜

ë³„ ëª¨ì–‘ì´ì—ìš”! â­
```

**ë¹„ë°€**: ê¸°ì—…ì´ ë˜‘ë˜‘í•œ ê²°ì •ì„ í•˜ë„ë¡ ë„ì™€ì¤˜ìš”! ğŸ“Šâœ¨
